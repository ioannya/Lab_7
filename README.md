## Структура проекта

```
Lab_7/
├─ domain/                     # Доменный слой
│  ├─ __init__.py
│  ├─ money.py                 # Value Object (деньги)
│  ├─ order_status.py          # Enum статусов заказа
│  ├─ order_line.py            # Строка заказа (часть агрегата)
│  └─ order.py                 # Сущность Order (агрегат)
│
├─ application/                # Слой приложения
│  ├─ __init__.py
│  ├─ interfaces.py            # Интерфейсы репозитория и платёжного шлюза
│  └─ pay_order_use_case.py    # Use-case оплаты заказа
│
├─ infrastructure/             # Инфраструктурный слой
│  ├─ __init__.py
│  ├─ in_memory_order_repository.py  # Репозиторий в памяти
│  └─ fake_payment_gateway.py        # Фейковый платёжный шлюз
│
├─ tests/                      # Тесты
│  ├─ __init__.py
│  └─ test_pay_order.py        # Тесты use-case и доменных инвариантов
│
└─ README.md
```

# Lab 7 — Layered Architecture & DDD-lite

## Описание
В данной лабораторной работе реализована упрощённая система оплаты заказа с использованием
слоистой архитектуры и принципов DDD-lite.

Проект разделён на доменный слой, слой приложения и инфраструктурный слой.
Бизнес-логика сосредоточена в доменной модели, use-case отвечает за сценарий оплаты,
а инфраструктура предоставляет технические реализации без использования реальной базы данных.

## Архитектура

Проект состоит из следующих слоёв:

### Domain
Содержит доменную модель и бизнес-правила:
- `Order` — сущность заказа
- `OrderLine` — строка заказа (часть агрегата)
- `Money` — value object для денежных значений
- `OrderStatus` — перечисление состояний заказа

В домене реализованы инварианты:
- нельзя оплатить пустой заказ
- нельзя оплатить заказ повторно
- после оплаты нельзя изменять заказ
- итоговая сумма равна сумме строк заказа

### Application
Содержит use-case:
- `PayOrderUseCase` — сценарий оплаты заказа

Use-case:
1. загружает заказ через репозиторий
2. выполняет доменную операцию оплаты
3. вызывает платёж через платёжный шлюз
4. сохраняет заказ

Также определены интерфейсы:
- `OrderRepository`
- `PaymentGateway`

### Infrastructure
Содержит реализации интерфейсов:
- `InMemoryOrderRepository` — репозиторий в памяти
- `FakePaymentGateway` — фейковый платёжный шлюз

Реальная база данных и внешние сервисы не используются.

### Tests
Тесты написаны с использованием `pytest` и проверяют:
- успешную оплату корректного заказа
- ошибку при оплате пустого заказа
- ошибку при повторной оплате
- невозможность изменения заказа после оплаты
- корректный расчёт итоговой суммы

